test$A <- -4
test
test[test<0] <- 0
test
devtools::load_all()
catch_function(1,Pollock=2e6,Sablefish=400)
test
test2
test2 <- data.frame(B=400,C=30,A=1)
pmin(test,test2)
test2 <- data.frame(B=400,C=-10,A=1)
pmin(test,test2)
catch_function(1,Pollock=1e6,PCod=1e6)
catch_function(1,Pollock=2e6,PCod=1e6)
catch_function(1,Pollock=2e6,PCod=1e5)
catch_function(1,Pollock=2e6,PCod=1e4)
catch_function(1,Pollock=2e6,PCod=1e4)
catch_function(1,Pollock=2e6,PCod=1e4)
library(devtools)
devtools::document()
ge
library(devtools)
load_all()
test()
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
document()
build()
unload()
install_github("amandafaig/catchfunction")
install_github("amandafaig/catchfunction", force=T)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
load_all()
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
document()
document()
unload()
install_github("amandafaig/catchfunction")
library(catchfunction)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1.3e6,PCod=2e5)
# Pre-amble ####
rm(list = ls())
library("data.table")
library("dplyr")
library("tidyr")
library("xtable")
library("ggplot2")
library("systemfit")
library("VGAM")
library("xlsx")
allspp <- c("141","204","103","102","147","303","60","100","310","202","106","301","201","104","307","203","400","65","326","90","50","140")
sppnames <- c("Arrowtooth_flounder", "Atka_mackerel", "Flathead_sole", "Greenland_turbot", "Kamchatka_flounder", "Northern_rockfish", "Octopus", "Other_flatfish",
"Other_rockfish", "Pacific_cod",  "Alaska_plaice", "Pacific_ocean_perch", "Pollock", "Rock_sole", "Rougheye_rockfish",  "Sablefish","Sculpin",
"Shark", "Shortraker", "Skate",  "Squid",  "Yellowfin_sole")
# What do you want to do? ####
# # # MODEL TYPE # # #
#  # # # # # # # # # #  # # # # # #  # # # # # #  # # # # # #  # #
# Do you want to make predictions using the SUR-SUR model? (True/False)
SURSUR <- FALSE
# Do you want to make predictions using the noSUR-noSUR model? (True/False)
NOSURNOSUR <- FALSE
# Do you want to make predictions using the SUR - noSUR model? (True/False)
SURNOSUR <- FALSE
# Do you want to make predictions using the noSUR-SUR model? (True/False)
NOSURSUR <- FALSE
# Do you want to make predictions using the main ad hoc model? (True/False)
ADHOC <- FALSE #(cannot interact with actual models: option illogical)
# Do you want ot make predictions using the ad hoc model where we just use the mean catch
ADHOCMEAN <- F
# Do you want to make predictions using the ad hoc model with no policy indicators?
ADHOCNOIND <- F
# Do you want to make predictions using the model with no A80 indicators (SUR/SUR)? (True/False)
NOA80 <- FALSE
# Do you want to make predictions using the model with no X variables that aren't obvious (SUR/SUR)? (True/False)
OBVI <- FALSE
# Do you want to make predictions using the model with no X variables from other species (OLS/OLS)? (True/False)
CISX <- FALSE
# Do you want to make predictions using the model with rock sole not in the SUR (SUR/SUR)?
NOROCKSOLE <-F
# Do you want to make predictions using the model with a flatfish SUR and a rockfish SUR (along with the std SUR)?
FLATSUR <- F
# Do you want to make predictions using the model where the first year any gropu exists is thrown out from the data?
NOFIRSTYEAR <- F
# # # SAMPLE TYPE (DEFAULT IS IN SAMPLE, IF BOTH ARE FALSE) # # #
#  # # # # # # # # # #  # # # # # #  # # # # # #  # # # # # #  # #
# Do you want to use out of sample data (TRUE) or in-sample data (FALSE)
OUTOFSAMPLE <- F
# Analysis/Output
# Do you want to plot whatever models were run?
PLOT <- FALSE
# Do you want to compare all the models? (True/False)
COMPARE <- T  # if true, edit modellist.  Search "EDITLIST4321" and you should find it.
## Import and organize data ####
ABC.DATA <- readRDS("data_GHS.rds") %>%
filter(SUBAREA == 'BSAI') %>%
select(YEAR,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
TAC.DATA <- readRDS("data_GHS.rds") %>%
filter(SUBAREA == 'BSAI') %>%
select(YEAR,SPECIES_CODE,TAC)
TAC.DATA <- within(TAC.DATA, title <- paste('TAC',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TAC)%>%
spread(title,TAC)
CATCH.DATA <- readRDS("BSAI_catch_data.rds") %>%
filter(SUBAREA == 'BSAI') %>%
filter(YEAR>1991)%>%
select(YEAR,SPECIES_CODE,TOTALCATCH)
CATCH.DATA <- within(CATCH.DATA, title <- paste('CATCH',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TOTALCATCH) %>%
spread(title,TOTALCATCH) %>%
select(-CATCH.901)
CATCH.DATA[CATCH.DATA == 0] <- NA
CATCH.DATA$NETCATCH <- rowSums(CATCH.DATA[,2:23], na.rm = TRUE)
FISH.DATA <- left_join(ABC.DATA,TAC.DATA,by="YEAR")
FISH.DATA <- left_join(FISH.DATA, CATCH.DATA, by = "YEAR")
FISH.DATA <- FISH.DATA %>%
mutate(flex = as.numeric(YEAR>2014)) %>% # introduction of flatfish flex
mutate(A80 = as.numeric(YEAR>2007)) %>%  # introduction of A80
mutate(sablefish.over.6k = as.numeric(ABC.203>6e3)) %>%  # sablefish upper bound
mutate(pcod.over.280k = as.numeric(ABC.202 >= 28e4)) %>% # pcod upper bound
mutate(pollock.UB = as.numeric(ABC.201 >= 1.25e6 & A80 == 1) + as.numeric(ABC.201 >= 1.4e6 & A80==0)) %>% # consider a single UB?
mutate(pollock.ABC = (1-pollock.UB)*ABC.201) %>% # Pollock ABC when not at UB
mutate(SSL = as.numeric(YEAR>2011))%>% # stellar sea lion closure
mutate(solegone = as.numeric(YEAR>1994)) %>%
mutate(plaicegone = as.numeric(YEAR>2002)) %>%
mutate(kamsplit = as.numeric(YEAR>2010)) #%>% filter(YEAR == 2016)
load_all()
library(devtools)
load_all()
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
load_all()
load_all()
catch_function(1,Pollock=1e6)
load_all()
library(devtools)
load_all()
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=1e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=3e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=4e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=3e5)
ABC.DATA <- readRDS("~/temp/data_GHS.rds")
library(devtools)
load_all()
load_all()
catch_function(1,Pollock=2e6)
tac_fit_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_fit_SUR_all.rds")
tac_fit_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_fit_NOSUR_all.rds")
catch_fit_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_fit_NOSUR_all.rds")
catch_fit_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_fit_SUR_all.rds")
tac_NOFIRSTYEAR_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_NOFIRSTYEAR_SUR_all.rds")
tac_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_NOFIRSTYEAR_NOSUR_all.rds")
catch_NOFIRSTYEAR_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_NOFIRSTYEAR_NOSUR_all.rds")
library("dplyr")
library("tidyr")
ABC.DATA <- readRDS("~/Desktop/CODE/data_GHS.rds") %>%
filter(SUBAREA %in% c('BSAI')) %>%
select(YEAR,SUBAREA,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
ABC.DATA <- select(ABC.DATA, -YEAR)
mean.BSAI.ABCs <- summarise_each(ABC.DATA, funs(mean(., na.rm=T)))
mean.BSAI.ABCs$ABC.BSAI.60[1] <- 2589
ABC.DATA <- readRDS("~/Desktop/CODE/data_GHS.rds") %>%
filter(SUBAREA %in% c('BS','AI')) %>%
select(YEAR,SUBAREA,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
ABC.DATA <- select(ABC.DATA, -YEAR)
ABC.DATA[ABC.DATA == 0] <- NA
mean.BS.AI.ABCs <- summarise_each(ABC.DATA, funs(mean(., na.rm=T)))
CATCH.DATA <- readRDS("~/Desktop/CODE/BSAI_catch_data.rds") %>%
filter(SUBAREA %in% c('BSAI','BS','AI')) %>%
filter(YEAR>1991)%>%
select(YEAR,SUBAREA, SPECIES_CODE,TOTALCATCH)
CATCH.DATA <- within(CATCH.DATA, title <- paste('CATCH',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TOTALCATCH) %>%
spread(title,TOTALCATCH)
CATCH.DATA[is.na(CATCH.DATA)] <- 0
CATCH.DATA <- select(CATCH.DATA,
- CATCH.AI.102,
- CATCH.AI.201,
- CATCH.AI.202,
- CATCH.AI.203,
- CATCH.AI.301,
- CATCH.AI.310,
- CATCH.BS.102,
- CATCH.BS.201,
- CATCH.BS.202,
- CATCH.BS.203,
- CATCH.BS.301,
- CATCH.BS.310)
CATCH.PER <- CATCH.DATA %>%
mutate(AI.100 = CATCH.AI.100/CATCH.BSAI.100) %>%
mutate(BS.100 = CATCH.BS.100/CATCH.BSAI.100) %>%
mutate(AI.103 = CATCH.AI.103/CATCH.BSAI.103) %>%
mutate(BS.103 = CATCH.BS.103/CATCH.BSAI.103) %>%
mutate(AI.104 = CATCH.AI.104/CATCH.BSAI.104) %>%
mutate(BS.104 = CATCH.BS.104/CATCH.BSAI.104) %>%
mutate(AI.106 = CATCH.AI.106/CATCH.BSAI.106) %>%
mutate(BS.106 = CATCH.BS.106/CATCH.BSAI.106) %>%
mutate(AI.140 = CATCH.AI.140/CATCH.BSAI.140) %>%
mutate(BS.140 = CATCH.BS.140/CATCH.BSAI.140) %>%
mutate(AI.141 = CATCH.AI.141/CATCH.BSAI.141) %>%
mutate(BS.141 = CATCH.BS.141/CATCH.BSAI.141) %>%
mutate(AI.147 = CATCH.AI.147/CATCH.BSAI.147) %>%
mutate(BS.147 = CATCH.BS.147/CATCH.BSAI.147) %>%
mutate(AI.204 = CATCH.AI.204/CATCH.BSAI.204) %>%
mutate(BS.204 = CATCH.BS.204/CATCH.BSAI.204) %>%
mutate(AI.303 = CATCH.AI.303/CATCH.BSAI.303) %>%
mutate(BS.303 = CATCH.BS.303/CATCH.BSAI.303) %>%
mutate(AI.307 = CATCH.AI.307/CATCH.BSAI.307) %>%
mutate(BS.307 = CATCH.BS.307/CATCH.BSAI.307) %>%
mutate(AI.326 = CATCH.AI.326/CATCH.BSAI.326) %>%
mutate(BS.326 = CATCH.BS.326/CATCH.BSAI.326) %>%
mutate(AI.400 = CATCH.AI.400/CATCH.BSAI.400) %>%
mutate(BS.400 = CATCH.BS.400/CATCH.BSAI.400) %>%
mutate(AI.50 = CATCH.AI.50/CATCH.BSAI.50) %>%
mutate(BS.50 = CATCH.BS.50/CATCH.BSAI.50) %>%
mutate(AI.60 = CATCH.AI.60/CATCH.BSAI.60) %>%
mutate(BS.60 = CATCH.BS.60/CATCH.BSAI.60) %>%
mutate(AI.65 = CATCH.AI.65/CATCH.BSAI.65) %>%
mutate(BS.65 = CATCH.BS.65/CATCH.BSAI.65) %>%
mutate(AI.90 = CATCH.AI.90/CATCH.BSAI.90) %>%
mutate(BS.90 = CATCH.BS.90/CATCH.BSAI.90)
CATCH.PER <- select(CATCH.PER, 59:90)
CATCH.PER <- summarise_each(CATCH.PER, funs(mean(., na.rm=T)))
mean.BS.AI.ABCs$ABC.AI.100 <- CATCH.PER$AI.100*mean.BSAI.ABCs$ABC.BSAI.100
mean.BS.AI.ABCs$ABC.BS.100 <- CATCH.PER$BS.100*mean.BSAI.ABCs$ABC.BSAI.100
mean.BS.AI.ABCs$ABC.AI.103 <- CATCH.PER$AI.103*mean.BSAI.ABCs$ABC.BSAI.103
mean.BS.AI.ABCs$ABC.BS.103 <- CATCH.PER$BS.103*mean.BSAI.ABCs$ABC.BSAI.103
mean.BS.AI.ABCs$ABC.AI.104 <- CATCH.PER$AI.104*mean.BSAI.ABCs$ABC.BSAI.104
mean.BS.AI.ABCs$ABC.BS.104 <- CATCH.PER$BS.104*mean.BSAI.ABCs$ABC.BSAI.104
mean.BS.AI.ABCs$ABC.AI.106 <- CATCH.PER$AI.106*mean.BSAI.ABCs$ABC.BSAI.106
mean.BS.AI.ABCs$ABC.BS.106 <- CATCH.PER$BS.106*mean.BSAI.ABCs$ABC.BSAI.106
mean.BS.AI.ABCs$ABC.AI.140 <- CATCH.PER$AI.140*mean.BSAI.ABCs$ABC.BSAI.140
mean.BS.AI.ABCs$ABC.BS.140 <- CATCH.PER$BS.140*mean.BSAI.ABCs$ABC.BSAI.140
mean.BS.AI.ABCs$ABC.AI.141 <- CATCH.PER$AI.141*mean.BSAI.ABCs$ABC.BSAI.141
mean.BS.AI.ABCs$ABC.BS.141 <- CATCH.PER$BS.141*mean.BSAI.ABCs$ABC.BSAI.141
mean.BS.AI.ABCs$ABC.AI.147 <- CATCH.PER$AI.147*mean.BSAI.ABCs$ABC.BSAI.147
mean.BS.AI.ABCs$ABC.BS.147 <- CATCH.PER$BS.147*mean.BSAI.ABCs$ABC.BSAI.147
mean.BS.AI.ABCs$ABC.AI.204 <- CATCH.PER$AI.204*mean.BSAI.ABCs$ABC.BSAI.204
mean.BS.AI.ABCs$ABC.BS.204 <- CATCH.PER$BS.204*mean.BSAI.ABCs$ABC.BSAI.204
mean.BS.AI.ABCs$ABC.AI.303 <- CATCH.PER$AI.303*mean.BSAI.ABCs$ABC.BSAI.303
mean.BS.AI.ABCs$ABC.BS.303 <- CATCH.PER$BS.303*mean.BSAI.ABCs$ABC.BSAI.303
mean.BS.AI.ABCs$ABC.AI.307 <- CATCH.PER$AI.307*mean.BSAI.ABCs$ABC.BSAI.307
mean.BS.AI.ABCs$ABC.BS.307 <- CATCH.PER$BS.307*mean.BSAI.ABCs$ABC.BSAI.307
mean.BS.AI.ABCs$ABC.AI.326 <- CATCH.PER$AI.326*mean.BSAI.ABCs$ABC.BSAI.326
mean.BS.AI.ABCs$ABC.BS.326 <- CATCH.PER$BS.326*mean.BSAI.ABCs$ABC.BSAI.326
mean.BS.AI.ABCs$ABC.AI.400 <- CATCH.PER$AI.400*mean.BSAI.ABCs$ABC.BSAI.400
mean.BS.AI.ABCs$ABC.BS.400 <- CATCH.PER$BS.400*mean.BSAI.ABCs$ABC.BSAI.400
mean.BS.AI.ABCs$ABC.AI.50 <- CATCH.PER$AI.50*mean.BSAI.ABCs$ABC.BSAI.50
mean.BS.AI.ABCs$ABC.BS.50 <- CATCH.PER$BS.50*mean.BSAI.ABCs$ABC.BSAI.50
mean.BS.AI.ABCs$ABC.AI.60 <- CATCH.PER$AI.60*mean.BSAI.ABCs$ABC.BSAI.60
mean.BS.AI.ABCs$ABC.BS.60 <- CATCH.PER$BS.60*mean.BSAI.ABCs$ABC.BSAI.60
mean.BS.AI.ABCs$ABC.AI.65 <- CATCH.PER$AI.65*mean.BSAI.ABCs$ABC.BSAI.65
mean.BS.AI.ABCs$ABC.BS.65 <- CATCH.PER$BS.65*mean.BSAI.ABCs$ABC.BSAI.65
mean.BS.AI.ABCs$ABC.AI.90 <- CATCH.PER$AI.90*mean.BSAI.ABCs$ABC.BSAI.90
mean.BS.AI.ABCs$ABC.BS.90 <- CATCH.PER$BS.90*mean.BSAI.ABCs$ABC.BSAI.90
mean.BS.AI.ABCs <- mean.BS.AI.ABCs %>% select(-ABC.BS.300)
library(devtools)
devtools::use_data(mean.BS.AI.ABCs,catch_fit_nosur,catch_fit_sur,catch_NOFIRSTYEAR_sur,catch_NOFIRSTYEAR_nosur,tac_fit_sur,tac_fit_nosur,tac_NOFIRSTYEAR_sur, tac_NOFIRSTYEAR_nosur, internal = TRUE, overwrite = TRUE)
load_all()
ABC.DATA <- mean.BS.AI.ABCs
ABC.DATA <- ABC.DATA %>%
mutate(ABC.BSAI.100 = ABC.BS.100 + ABC.AI.100) %>%
mutate(ABC.BSAI.103 = ABC.BS.103 + ABC.AI.103) %>%
mutate(ABC.BSAI.104 = ABC.BS.104 + ABC.AI.104) %>%
mutate(ABC.BSAI.106 = ABC.BS.106 + ABC.AI.106) %>%
mutate(ABC.BSAI.140 = ABC.BS.140 + ABC.AI.140) %>%
mutate(ABC.BSAI.141 = ABC.BS.141 + ABC.AI.141) %>%
mutate(ABC.BSAI.147 = ABC.BS.147 + ABC.AI.147) %>%
mutate(ABC.BSAI.204 = ABC.BS.204 + ABC.AI.204) %>%
mutate(ABC.BSAI.303 = ABC.BS.303 + ABC.AI.303) %>%
mutate(ABC.BSAI.307 = ABC.BS.307 + ABC.AI.307) %>%
mutate(ABC.BSAI.326 = ABC.BS.326 + ABC.AI.326) %>%
mutate(ABC.BSAI.400 = ABC.BS.400 + ABC.AI.400) %>%
mutate(ABC.BSAI.50 = ABC.BS.50 + ABC.AI.50) %>%
mutate(ABC.BSAI.60 = ABC.BS.60 + ABC.AI.60) %>%
mutate(ABC.BSAI.65 = ABC.BS.65 + ABC.AI.65) %>%
mutate(ABC.BSAI.90 = ABC.BS.90 + ABC.AI.90) %>%
mutate(ABC.BSAI.202 = ABC.BS.202 + ABC.AI.202)
catch <- statusquo_catch(ABC.DATA)
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
View(catch)
View(CATCH.DATA)
View(mean.BS.AI.ABCs)
View(ABC.DATA)
catch <- statusquo_catch(ABC.DATA)
load_all()
catch <- statusquo_catch(ABC.DATA)
View(mean.BS.AI.ABCs)
load_all()
catch_function(1,Pollock=1e6)
catch_function(1,Pollock=1e5)
catch_function(1,Pollock=1e8)
catch_function(1,Pollock=2e6)
View(CATCH.DATA)
tac_fit_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_fit_SUR_all.rds")
tac_fit_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_fit_NOSUR_all.rds")
catch_fit_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_fit_NOSUR_all.rds")
catch_fit_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_fit_SUR_all.rds")
tac_NOFIRSTYEAR_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_NOFIRSTYEAR_SUR_all.rds")
tac_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_TAC_NOFIRSTYEAR_NOSUR_all.rds")
catch_NOFIRSTYEAR_sur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/CODE/fits/BS_and_AI_CATCH_NOFIRSTYEAR_NOSUR_all.rds")
library("dplyr")
library("tidyr")
ABC.DATA <- readRDS("~/Desktop/CODE/data_GHS.rds") %>%
filter(SUBAREA %in% c('BSAI')) %>%
select(YEAR,SUBAREA,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
ABC.DATA <- select(ABC.DATA, -YEAR)
mean.BSAI.ABCs <- summarise_each(ABC.DATA, funs(mean(., na.rm=T)))
mean.BSAI.ABCs$ABC.BSAI.60[1] <- 2589
ABC.DATA <- readRDS("~/Desktop/CODE/data_GHS.rds") %>%
filter(SUBAREA %in% c('BS','AI')) %>%
select(YEAR,SUBAREA,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
ABC.DATA <- select(ABC.DATA, -YEAR)
ABC.DATA[ABC.DATA == 0] <- NA
mean.BS.AI.ABCs <- summarise_each(ABC.DATA, funs(mean(., na.rm=T)))
CATCH.DATA <- readRDS("~/Desktop/CODE/BSAI_catch_data.rds") %>%
filter(SUBAREA %in% c('BSAI','BS','AI')) %>%
filter(YEAR>1991)%>%
select(YEAR,SUBAREA, SPECIES_CODE,TOTALCATCH)
CATCH.DATA <- within(CATCH.DATA, title <- paste('CATCH',SUBAREA,SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TOTALCATCH) %>%
spread(title,TOTALCATCH)
CATCH.DATA[is.na(CATCH.DATA)] <- 0
CATCH.DATA <- select(CATCH.DATA,
- CATCH.AI.102,
- CATCH.AI.201,
- CATCH.AI.202,
- CATCH.AI.203,
- CATCH.AI.301,
- CATCH.AI.310,
- CATCH.BS.102,
- CATCH.BS.201,
- CATCH.BS.202,
- CATCH.BS.203,
- CATCH.BS.301,
- CATCH.BS.310)
CATCH.PER <- CATCH.DATA %>%
mutate(AI.100 = CATCH.AI.100/CATCH.BSAI.100) %>%
mutate(BS.100 = CATCH.BS.100/CATCH.BSAI.100) %>%
mutate(AI.103 = CATCH.AI.103/CATCH.BSAI.103) %>%
mutate(BS.103 = CATCH.BS.103/CATCH.BSAI.103) %>%
mutate(AI.104 = CATCH.AI.104/CATCH.BSAI.104) %>%
mutate(BS.104 = CATCH.BS.104/CATCH.BSAI.104) %>%
mutate(AI.106 = CATCH.AI.106/CATCH.BSAI.106) %>%
mutate(BS.106 = CATCH.BS.106/CATCH.BSAI.106) %>%
mutate(AI.140 = CATCH.AI.140/CATCH.BSAI.140) %>%
mutate(BS.140 = CATCH.BS.140/CATCH.BSAI.140) %>%
mutate(AI.141 = CATCH.AI.141/CATCH.BSAI.141) %>%
mutate(BS.141 = CATCH.BS.141/CATCH.BSAI.141) %>%
mutate(AI.147 = CATCH.AI.147/CATCH.BSAI.147) %>%
mutate(BS.147 = CATCH.BS.147/CATCH.BSAI.147) %>%
mutate(AI.204 = CATCH.AI.204/CATCH.BSAI.204) %>%
mutate(BS.204 = CATCH.BS.204/CATCH.BSAI.204) %>%
mutate(AI.303 = CATCH.AI.303/CATCH.BSAI.303) %>%
mutate(BS.303 = CATCH.BS.303/CATCH.BSAI.303) %>%
mutate(AI.307 = CATCH.AI.307/CATCH.BSAI.307) %>%
mutate(BS.307 = CATCH.BS.307/CATCH.BSAI.307) %>%
mutate(AI.326 = CATCH.AI.326/CATCH.BSAI.326) %>%
mutate(BS.326 = CATCH.BS.326/CATCH.BSAI.326) %>%
mutate(AI.400 = CATCH.AI.400/CATCH.BSAI.400) %>%
mutate(BS.400 = CATCH.BS.400/CATCH.BSAI.400) %>%
mutate(AI.50 = CATCH.AI.50/CATCH.BSAI.50) %>%
mutate(BS.50 = CATCH.BS.50/CATCH.BSAI.50) %>%
mutate(AI.60 = CATCH.AI.60/CATCH.BSAI.60) %>%
mutate(BS.60 = CATCH.BS.60/CATCH.BSAI.60) %>%
mutate(AI.65 = CATCH.AI.65/CATCH.BSAI.65) %>%
mutate(BS.65 = CATCH.BS.65/CATCH.BSAI.65) %>%
mutate(AI.90 = CATCH.AI.90/CATCH.BSAI.90) %>%
mutate(BS.90 = CATCH.BS.90/CATCH.BSAI.90)
CATCH.PER <- select(CATCH.PER, 59:90)
CATCH.PER <- summarise_each(CATCH.PER, funs(mean(., na.rm=T)))
mean.BS.AI.ABCs$ABC.AI.100 <- CATCH.PER$AI.100*mean.BSAI.ABCs$ABC.BSAI.100
mean.BS.AI.ABCs$ABC.BS.100 <- CATCH.PER$BS.100*mean.BSAI.ABCs$ABC.BSAI.100
mean.BS.AI.ABCs$ABC.AI.103 <- CATCH.PER$AI.103*mean.BSAI.ABCs$ABC.BSAI.103
mean.BS.AI.ABCs$ABC.BS.103 <- CATCH.PER$BS.103*mean.BSAI.ABCs$ABC.BSAI.103
mean.BS.AI.ABCs$ABC.AI.104 <- CATCH.PER$AI.104*mean.BSAI.ABCs$ABC.BSAI.104
mean.BS.AI.ABCs$ABC.BS.104 <- CATCH.PER$BS.104*mean.BSAI.ABCs$ABC.BSAI.104
mean.BS.AI.ABCs$ABC.AI.106 <- CATCH.PER$AI.106*mean.BSAI.ABCs$ABC.BSAI.106
mean.BS.AI.ABCs$ABC.BS.106 <- CATCH.PER$BS.106*mean.BSAI.ABCs$ABC.BSAI.106
mean.BS.AI.ABCs$ABC.AI.140 <- CATCH.PER$AI.140*mean.BSAI.ABCs$ABC.BSAI.140
mean.BS.AI.ABCs$ABC.BS.140 <- CATCH.PER$BS.140*mean.BSAI.ABCs$ABC.BSAI.140
mean.BS.AI.ABCs$ABC.AI.141 <- CATCH.PER$AI.141*mean.BSAI.ABCs$ABC.BSAI.141
mean.BS.AI.ABCs$ABC.BS.141 <- CATCH.PER$BS.141*mean.BSAI.ABCs$ABC.BSAI.141
mean.BS.AI.ABCs$ABC.AI.147 <- CATCH.PER$AI.147*mean.BSAI.ABCs$ABC.BSAI.147
mean.BS.AI.ABCs$ABC.BS.147 <- CATCH.PER$BS.147*mean.BSAI.ABCs$ABC.BSAI.147
mean.BS.AI.ABCs$ABC.AI.204 <- CATCH.PER$AI.204*mean.BSAI.ABCs$ABC.BSAI.204
mean.BS.AI.ABCs$ABC.BS.204 <- CATCH.PER$BS.204*mean.BSAI.ABCs$ABC.BSAI.204
mean.BS.AI.ABCs$ABC.AI.303 <- CATCH.PER$AI.303*mean.BSAI.ABCs$ABC.BSAI.303
mean.BS.AI.ABCs$ABC.BS.303 <- CATCH.PER$BS.303*mean.BSAI.ABCs$ABC.BSAI.303
mean.BS.AI.ABCs$ABC.AI.307 <- CATCH.PER$AI.307*mean.BSAI.ABCs$ABC.BSAI.307
mean.BS.AI.ABCs$ABC.BS.307 <- CATCH.PER$BS.307*mean.BSAI.ABCs$ABC.BSAI.307
mean.BS.AI.ABCs$ABC.AI.326 <- CATCH.PER$AI.326*mean.BSAI.ABCs$ABC.BSAI.326
mean.BS.AI.ABCs$ABC.BS.326 <- CATCH.PER$BS.326*mean.BSAI.ABCs$ABC.BSAI.326
mean.BS.AI.ABCs$ABC.AI.400 <- CATCH.PER$AI.400*mean.BSAI.ABCs$ABC.BSAI.400
mean.BS.AI.ABCs$ABC.BS.400 <- CATCH.PER$BS.400*mean.BSAI.ABCs$ABC.BSAI.400
mean.BS.AI.ABCs$ABC.AI.50 <- CATCH.PER$AI.50*mean.BSAI.ABCs$ABC.BSAI.50
mean.BS.AI.ABCs$ABC.BS.50 <- CATCH.PER$BS.50*mean.BSAI.ABCs$ABC.BSAI.50
mean.BS.AI.ABCs$ABC.AI.60 <- CATCH.PER$AI.60*mean.BSAI.ABCs$ABC.BSAI.60
mean.BS.AI.ABCs$ABC.BS.60 <- CATCH.PER$BS.60*mean.BSAI.ABCs$ABC.BSAI.60
mean.BS.AI.ABCs$ABC.AI.65 <- CATCH.PER$AI.65*mean.BSAI.ABCs$ABC.BSAI.65
mean.BS.AI.ABCs$ABC.BS.65 <- CATCH.PER$BS.65*mean.BSAI.ABCs$ABC.BSAI.65
mean.BS.AI.ABCs$ABC.AI.90 <- CATCH.PER$AI.90*mean.BSAI.ABCs$ABC.BSAI.90
mean.BS.AI.ABCs$ABC.BS.90 <- CATCH.PER$BS.90*mean.BSAI.ABCs$ABC.BSAI.90
mean.BS.AI.ABCs <- mean.BS.AI.ABCs %>% select(-ABC.BS.300)
library(devtools)
devtools::use_data(mean.BS.AI.ABCs,catch_fit_nosur,catch_fit_sur,catch_NOFIRSTYEAR_sur,catch_NOFIRSTYEAR_nosur,tac_fit_sur,tac_fit_nosur,tac_NOFIRSTYEAR_sur, tac_NOFIRSTYEAR_nosur, internal = TRUE, overwrite = TRUE)
load_all()
ABC.DATA <- mean.BS.AI.ABCs
ABC.DATA <- ABC.DATA %>%
mutate(ABC.BSAI.100 = ABC.BS.100 + ABC.AI.100) %>%
mutate(ABC.BSAI.103 = ABC.BS.103 + ABC.AI.103) %>%
mutate(ABC.BSAI.104 = ABC.BS.104 + ABC.AI.104) %>%
mutate(ABC.BSAI.106 = ABC.BS.106 + ABC.AI.106) %>%
mutate(ABC.BSAI.140 = ABC.BS.140 + ABC.AI.140) %>%
mutate(ABC.BSAI.141 = ABC.BS.141 + ABC.AI.141) %>%
mutate(ABC.BSAI.147 = ABC.BS.147 + ABC.AI.147) %>%
mutate(ABC.BSAI.204 = ABC.BS.204 + ABC.AI.204) %>%
mutate(ABC.BSAI.303 = ABC.BS.303 + ABC.AI.303) %>%
mutate(ABC.BSAI.307 = ABC.BS.307 + ABC.AI.307) %>%
mutate(ABC.BSAI.326 = ABC.BS.326 + ABC.AI.326) %>%
mutate(ABC.BSAI.400 = ABC.BS.400 + ABC.AI.400) %>%
mutate(ABC.BSAI.50 = ABC.BS.50 + ABC.AI.50) %>%
mutate(ABC.BSAI.60 = ABC.BS.60 + ABC.AI.60) %>%
mutate(ABC.BSAI.65 = ABC.BS.65 + ABC.AI.65) %>%
mutate(ABC.BSAI.90 = ABC.BS.90 + ABC.AI.90) %>%
mutate(ABC.BSAI.202 = ABC.BS.202 + ABC.AI.202)
catch <- statusquo_catch(ABC.DATA)
View(catch)
catch_function(1,Atka = 4e6)
catch_function(1,Atka = 7e6)
catch_function(1,Atka = 20e6)
catch_function(1,Pollock = 2e6, Atka = 4)
catch_function(1,Pollock = 1e6, Atka = 4e5)
catch_function(1,Pollock = 1.6e6, Atka = 4e5)
catch_function(1,Pollock = 1.6e6, POP = 1e4, Atka = 4e5)
catch_function(1,Pollock = 1.6e6, POP = 5e4, Atka = 4e5)
catch_function(1,Pollock = 1.6e6, POP = 5e5, Atka = 4e5)
