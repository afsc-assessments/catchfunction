library("devtools")
tac_fit_sur <- readRDS("~/Desktop/temp/fits/BSAI_TAC_fit_SUR_all.rds")
catch_fit_nosur <- readRDS("~/Desktop/temp/fits/BSAI_CATCH_fit_NOSUR_all.rds")
catch_fit_sur <- readRDS("~/Desktop/temp/fits/BSAI_CATCH_fit_SUR_all.rds")
tac_NOROCKSOLE_sur <- readRDS("~/Desktop/temp/fits/TAC_NOROCKSOLE_SUR_all.rds")
catch_NOROCKSOLE_sur <- readRDS("~/Desktop/temp/fits/CATCH_NOROCKSOLE_SUR_all.rds")
tac_FLATSUR_sur <- readRDS("~/Desktop/temp/fits/TAC_FLATSUR_SUR_all.rds")
catch_FLATSUR_sur <- readRDS("~/Desktop/temp/fits/CATCH_FLATSUR_SUR_all.rds")
tac_NOFIRSTYEAR_sur <- readRDS("~/Desktop/temp/fits/TAC_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_sur <- readRDS("~/Desktop/temp/fits/CATCH_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/temp/fits/CATCH_NOFIRSTYEAR_NOSUR_all.rds")
ABC_meansd <- readRDS("~/Desktop/temp/ABC_meansd.rds")
devtools::use_data(        tac_fit_sur,
catch_fit_nosur,
catch_fit_sur,
tac_NOROCKSOLE_sur,
catch_NOROCKSOLE_sur,
tac_FLATSUR_sur,
catch_FLATSUR_sur,
tac_NOFIRSTYEAR_sur,
catch_NOFIRSTYEAR_sur,
catch_NOFIRSTYEAR_nosur,
ABC_meansd,
internal = T)
tac_fit_sur <- readRDS("~/Desktop/temp/fits/BSAI_TAC_fit_SUR_all.rds")
catch_fit_nosur <- readRDS("~/Desktop/temp/fits/BSAI_CATCH_fit_NOSUR_all.rds")
catch_fit_sur <- readRDS("~/Desktop/temp/fits/BSAI_CATCH_fit_SUR_all.rds")
tac_NOROCKSOLE_sur <- readRDS("~/Desktop/temp/fits/TAC_NOROCKSOLE_SUR_all.rds")
catch_NOROCKSOLE_sur <- readRDS("~/Desktop/temp/fits/CATCH_NOROCKSOLE_SUR_all.rds")
tac_FLATSUR_sur <- readRDS("~/Desktop/temp/fits/TAC_FLATSUR_SUR_all.rds")
catch_FLATSUR_sur <- readRDS("~/Desktop/temp/fits/CATCH_FLATSUR_SUR_all.rds")
tac_NOFIRSTYEAR_sur <- readRDS("~/Desktop/temp/fits/TAC_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_sur <- readRDS("~/Desktop/temp/fits/CATCH_NOFIRSTYEAR_SUR_all.rds")
catch_NOFIRSTYEAR_nosur <- readRDS("~/Desktop/temp/fits/CATCH_NOFIRSTYEAR_NOSUR_all.rds")
ABC_meansd <- readRDS("~/Desktop/temp/ABC_meansd.rds")
devtools::use_data(        tac_fit_sur,
catch_fit_nosur,
catch_fit_sur,
tac_NOROCKSOLE_sur,
catch_NOROCKSOLE_sur,
tac_FLATSUR_sur,
catch_FLATSUR_sur,
tac_NOFIRSTYEAR_sur,
catch_NOFIRSTYEAR_sur,
catch_NOFIRSTYEAR_nosur,
ABC_meansd,
internal = T,
overwrite = T)
devtools::load_all()
devtools::load_all()
catchfunction(1,Pollock=3e5)
catch_function(1,Pollock=3e5)
devtools::load_all()
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::document()
devtools::document()
install_packages("roxygen2")
install.packages("roxygen2")
install.packages("roxygen2")
library("devtools")
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,pollock=2e6)
catch_function(1,Pollock=2e6)
PREDICTIONS <- data.frame(TAC.60=0)
View(PREDICTIONS)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::document()
devtools::load_all()
catch_function(1,Pollock=2e6)
View(PREDICTIONS)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
catch_function(1,Pollock=2e6,PCod=1e5)
catch_function(1,Pollock=2e6,PCod=1e5,Arrowtooth=400)
test <- data.table(A=1,B=3,C=5)
test <- data.frame(A=1,B=3,C=5)
test2 <- data.frame(A=3,B=1,C=9)
pmin(test1,test2)
pmin(test,test2)
devtools::document()
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
devtools::load_all()
catch_function(1,Pollock=2e6)
catch_function(1,Pollock=2e6,Sablefish=400)
test
test$A <- -4
test
test[test<0] <- 0
test
devtools::load_all()
catch_function(1,Pollock=2e6,Sablefish=400)
test
test2
test2 <- data.frame(B=400,C=30,A=1)
pmin(test,test2)
test2 <- data.frame(B=400,C=-10,A=1)
pmin(test,test2)
catch_function(1,Pollock=1e6,PCod=1e6)
catch_function(1,Pollock=2e6,PCod=1e6)
catch_function(1,Pollock=2e6,PCod=1e5)
catch_function(1,Pollock=2e6,PCod=1e4)
catch_function(1,Pollock=2e6,PCod=1e4)
catch_function(1,Pollock=2e6,PCod=1e4)
library(devtools)
devtools::document()
ge
library(devtools)
load_all()
test()
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
catch_function(1,Pollock=2e6,Yellowfin=1e5)
document()
build()
unload()
install_github("amandafaig/catchfunction")
install_github("amandafaig/catchfunction", force=T)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
library(catchfunction)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
load_all()
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
catch_function(1,Pollock=2e6,PCod=2e5)
document()
document()
unload()
install_github("amandafaig/catchfunction")
library(catchfunction)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1e6,PCod=2e5)
catch_function(1,Pollock=1.3e6,PCod=2e5)
# Pre-amble ####
rm(list = ls())
library("data.table")
library("dplyr")
library("tidyr")
library("xtable")
library("ggplot2")
library("systemfit")
library("VGAM")
library("xlsx")
allspp <- c("141","204","103","102","147","303","60","100","310","202","106","301","201","104","307","203","400","65","326","90","50","140")
sppnames <- c("Arrowtooth_flounder", "Atka_mackerel", "Flathead_sole", "Greenland_turbot", "Kamchatka_flounder", "Northern_rockfish", "Octopus", "Other_flatfish",
"Other_rockfish", "Pacific_cod",  "Alaska_plaice", "Pacific_ocean_perch", "Pollock", "Rock_sole", "Rougheye_rockfish",  "Sablefish","Sculpin",
"Shark", "Shortraker", "Skate",  "Squid",  "Yellowfin_sole")
# What do you want to do? ####
# # # MODEL TYPE # # #
#  # # # # # # # # # #  # # # # # #  # # # # # #  # # # # # #  # #
# Do you want to make predictions using the SUR-SUR model? (True/False)
SURSUR <- FALSE
# Do you want to make predictions using the noSUR-noSUR model? (True/False)
NOSURNOSUR <- FALSE
# Do you want to make predictions using the SUR - noSUR model? (True/False)
SURNOSUR <- FALSE
# Do you want to make predictions using the noSUR-SUR model? (True/False)
NOSURSUR <- FALSE
# Do you want to make predictions using the main ad hoc model? (True/False)
ADHOC <- FALSE #(cannot interact with actual models: option illogical)
# Do you want ot make predictions using the ad hoc model where we just use the mean catch
ADHOCMEAN <- F
# Do you want to make predictions using the ad hoc model with no policy indicators?
ADHOCNOIND <- F
# Do you want to make predictions using the model with no A80 indicators (SUR/SUR)? (True/False)
NOA80 <- FALSE
# Do you want to make predictions using the model with no X variables that aren't obvious (SUR/SUR)? (True/False)
OBVI <- FALSE
# Do you want to make predictions using the model with no X variables from other species (OLS/OLS)? (True/False)
CISX <- FALSE
# Do you want to make predictions using the model with rock sole not in the SUR (SUR/SUR)?
NOROCKSOLE <-F
# Do you want to make predictions using the model with a flatfish SUR and a rockfish SUR (along with the std SUR)?
FLATSUR <- F
# Do you want to make predictions using the model where the first year any gropu exists is thrown out from the data?
NOFIRSTYEAR <- F
# # # SAMPLE TYPE (DEFAULT IS IN SAMPLE, IF BOTH ARE FALSE) # # #
#  # # # # # # # # # #  # # # # # #  # # # # # #  # # # # # #  # #
# Do you want to use out of sample data (TRUE) or in-sample data (FALSE)
OUTOFSAMPLE <- F
# Analysis/Output
# Do you want to plot whatever models were run?
PLOT <- FALSE
# Do you want to compare all the models? (True/False)
COMPARE <- T  # if true, edit modellist.  Search "EDITLIST4321" and you should find it.
## Import and organize data ####
ABC.DATA <- readRDS("data_GHS.rds") %>%
filter(SUBAREA == 'BSAI') %>%
select(YEAR,SPECIES_CODE,ABC)
ABC.DATA <- within(ABC.DATA, title <- paste('ABC',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,ABC) %>%
spread(title,ABC)
TAC.DATA <- readRDS("data_GHS.rds") %>%
filter(SUBAREA == 'BSAI') %>%
select(YEAR,SPECIES_CODE,TAC)
TAC.DATA <- within(TAC.DATA, title <- paste('TAC',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TAC)%>%
spread(title,TAC)
CATCH.DATA <- readRDS("BSAI_catch_data.rds") %>%
filter(SUBAREA == 'BSAI') %>%
filter(YEAR>1991)%>%
select(YEAR,SPECIES_CODE,TOTALCATCH)
CATCH.DATA <- within(CATCH.DATA, title <- paste('CATCH',SPECIES_CODE,sep='.')) %>%
select(YEAR,title,TOTALCATCH) %>%
spread(title,TOTALCATCH) %>%
select(-CATCH.901)
CATCH.DATA[CATCH.DATA == 0] <- NA
CATCH.DATA$NETCATCH <- rowSums(CATCH.DATA[,2:23], na.rm = TRUE)
FISH.DATA <- left_join(ABC.DATA,TAC.DATA,by="YEAR")
FISH.DATA <- left_join(FISH.DATA, CATCH.DATA, by = "YEAR")
FISH.DATA <- FISH.DATA %>%
mutate(flex = as.numeric(YEAR>2014)) %>% # introduction of flatfish flex
mutate(A80 = as.numeric(YEAR>2007)) %>%  # introduction of A80
mutate(sablefish.over.6k = as.numeric(ABC.203>6e3)) %>%  # sablefish upper bound
mutate(pcod.over.280k = as.numeric(ABC.202 >= 28e4)) %>% # pcod upper bound
mutate(pollock.UB = as.numeric(ABC.201 >= 1.25e6 & A80 == 1) + as.numeric(ABC.201 >= 1.4e6 & A80==0)) %>% # consider a single UB?
mutate(pollock.ABC = (1-pollock.UB)*ABC.201) %>% # Pollock ABC when not at UB
mutate(SSL = as.numeric(YEAR>2011))%>% # stellar sea lion closure
mutate(solegone = as.numeric(YEAR>1994)) %>%
mutate(plaicegone = as.numeric(YEAR>2002)) %>%
mutate(kamsplit = as.numeric(YEAR>2010)) #%>% filter(YEAR == 2016)
load_all()
library(devtools)
load_all()
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
catch_function(1,Pollock=1e6)
load_all()
load_all()
load_all()
catch_function(1,Pollock=1e6)
load_all()
library(devtools)
load_all()
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=1e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=5e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=5e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=1e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=3e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=9e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=4e5)
catch_function(1,Pollock=1e6,PCod=2e5,Yellowfin=3e5)
